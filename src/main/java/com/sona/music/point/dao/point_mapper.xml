<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC   "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd"
>
<mapper namespace="com.sona.music.point.dao.PointDAO">

	<insert id="joinCreatePoint">
		INSERT INTO USER_POINT(USER_ID, POINT_TYPE, POINT) 
			VALUES(#{param1},"아이디생성",0)
	</insert>

	<select id="getHavePoint" resultType="Integer">
		SELECT SUM(POINT) FROM USER_POINT where USER_ID = #{param1};
	</select>
	
	<insert id="pointChange">
		INSERT INTO USER_POINT(USER_ID, POINT_TYPE, POINT) 
			VALUES(#{param1},#{param3},#{param2});
	</insert>
	
	<select id="paymentGetLesson" resultType="com.sona.music.lesson.dto.LessonDTO">
		SELECT *,
			(SELECT USER_NAME FROM USERS WHERE USERS.USER_ID = CLASS_OPEN.USER_ID) 
			AS USER_NAME FROM CLASS_OPEN
			WHERE CLASS_IDX = #{param1};
	</select>
	
	<insert id="lessonPayApyHistory" >
		INSERT INTO APPLY_HISTORY(CLASS_IDX,USER_ID,APPLY_STATE)
			VALUES(#{param1},#{param2},#{param3});
			
	</insert>
	
	<select id="getPhotoName">
		SELECT NEW_FILENAME FROM PHOTO_BOARD WHERE USER_ID = #{param1} AND PHOTO_CATEGORY = #{param2} limit 1;
	</select>
</mapper>